<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Icon Background Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel h2::before {
            content: '‚óè';
            color: #764ba2;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        textarea, input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 150px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .preview-container {
            background: white;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        #preview {
            max-width: 100%;
            max-height: 400px;
            border: 2px dashed #ccc;
            border-radius: 10px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .settings {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #ffc107;
        }

        .settings h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .setting-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 10px;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
        }

        .setting-item label {
            font-size: 14px;
            margin-bottom: 5px;
        }

        .setting-item input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .info-box {
            background: #d1ecf1;
            border: 2px solid #bee5eb;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            color: #0c5460;
        }

        .info-box ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .info-box li {
            margin-bottom: 5px;
        }

        .error {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }

        .success {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® SVG Icon Background Tool</h1>
        <p class="subtitle">–°—Ç–≤–æ—Ä—é–π—Ç–µ –∫—Ä–∞—Å–∏–≤—ñ —ñ–∫–æ–Ω–∫–∏ –∑ —Ñ–æ–Ω–æ–º —à–≤–∏–¥–∫–æ —Ç–∞ –ª–µ–≥–∫–æ</p>

        <div class="settings">
            <h3>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</h3>
            <div class="setting-row">
                <div class="setting-item">
                    <label for="outputWidth">–®–∏—Ä–∏–Ω–∞ PNG (px):</label>
                    <input type="number" id="outputWidth" value="512" min="64" max="2048">
                </div>
                <div class="setting-item">
                    <label for="outputHeight">–í–∏—Å–æ—Ç–∞ PNG (px):</label>
                    <input type="number" id="outputHeight" value="512" min="64" max="2048">
                </div>
                <div class="setting-item">
                    <label for="iconSize">–†–æ–∑–º—ñ—Ä —ñ–∫–æ–Ω–∫–∏ (%):</label>
                    <input type="number" id="iconSize" value="60" min="10" max="100">
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="panel">
                <h2>–§–æ–Ω–æ–≤–∏–π SVG</h2>
                <div class="input-group">
                    <label for="backgroundSvg">–í—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥ —Ñ–æ–Ω—É:</label>
                    <textarea id="backgroundSvg" placeholder='<svg viewBox="0 0 100 100">...</svg>'></textarea>
                    <div class="error" id="bgError"></div>
                </div>
            </div>

            <div class="panel">
                <h2>SVG –Ü–∫–æ–Ω–∫–∞</h2>
                <div class="input-group">
                    <label for="iconSvg">–í—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥ —ñ–∫–æ–Ω–∫–∏:</label>
                    <textarea id="iconSvg" placeholder='<svg viewBox="0 0 24 24">...</svg>'></textarea>
                    <div class="error" id="iconError"></div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>üëÅÔ∏è –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥</h2>
            <div class="preview-container">
                <div id="preview"></div>
            </div>
            <div class="success" id="successMsg"></div>
        </div>

        <div class="buttons">
            <button class="btn-primary" onclick="updatePreview()">üîÑ –û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–µ–≤'—é</button>
            <button class="btn-success" onclick="downloadSVG()">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ SVG</button>
            <button class="btn-info" onclick="downloadPNG()">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ PNG</button>
        </div>

        <div class="info-box">
            <strong>üìù –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:</strong>
            <ul>
                <li>–í—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥ –¥–ª—è —Ñ–æ–Ω—É —Ç–∞ —ñ–∫–æ–Ω–∫–∏</li>
                <li>–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Ä–æ–∑–º—ñ—Ä –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ PNG —Ç–∞ —Ä–æ–∑–º—ñ—Ä —ñ–∫–æ–Ω–∫–∏</li>
                <li>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–µ–≤'—é" —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
                <li>–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ SVG –∞–±–æ PNG</li>
            </ul>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è —Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥—É SVG
        function cleanSVG(svgString) {
            // –í–∏–¥–∞–ª—è—î–º–æ XML –¥–µ–∫–ª–∞—Ä–∞—Ü—ñ—ó, DOCTYPE, –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ
            svgString = svgString.trim()
                .replace(/<\?xml[^>]*\?>/g, '')
                .replace(/<!DOCTYPE[^>]*>/g, '')
                .replace(/<!--[\s\S]*?-->/g, '');
            
            return svgString;
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó SVG
        function validateSVG(svgString, errorElementId) {
            const errorEl = document.getElementById(errorElementId);
            errorEl.style.display = 'none';

            if (!svgString || svgString.trim() === '') {
                errorEl.textContent = 'SVG –∫–æ–¥ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º';
                errorEl.style.display = 'block';
                return false;
            }

            const cleaned = cleanSVG(svgString);
            if (!cleaned.includes('<svg')) {
                errorEl.textContent = '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π SVG –∫–æ–¥: –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ —Ç–µ–≥ <svg>';
                errorEl.style.display = 'block';
                return false;
            }

            return true;
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–µ–≤'—é
        function updatePreview() {
            const backgroundSvg = document.getElementById('backgroundSvg').value;
            const iconSvg = document.getElementById('iconSvg').value;
            const iconSizePercent = parseInt(document.getElementById('iconSize').value) || 60;

            // –í–∞–ª—ñ–¥–∞—Ü—ñ—è
            const bgValid = validateSVG(backgroundSvg, 'bgError');
            const iconValid = validateSVG(iconSvg, 'iconError');

            if (!bgValid || !iconValid) {
                return;
            }

            try {
                // –û—á–∏—â–∞—î–º–æ SVG
                const cleanedBg = cleanSVG(backgroundSvg);
                const cleanedIcon = cleanSVG(iconSvg);

                // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π SVG
                const parser = new DOMParser();
                const bgDoc = parser.parseFromString(cleanedBg, 'image/svg+xml');
                const iconDoc = parser.parseFromString(cleanedIcon, 'image/svg+xml');

                const bgSvg = bgDoc.querySelector('svg');
                const iconSvgEl = iconDoc.querySelector('svg');

                if (!bgSvg || !iconSvgEl) {
                    throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ SVG');
                }

                // –û—Ç—Ä–∏–º—É—î–º–æ viewBox —Ñ–æ–Ω—É
                let viewBox = bgSvg.getAttribute('viewBox') || '0 0 100 100';
                let [x, y, width, height] = viewBox.split(' ').map(Number);

                // –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π SVG
                const finalSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                finalSvg.setAttribute('viewBox', viewBox);
                finalSvg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
                finalSvg.setAttribute('width', width);
                finalSvg.setAttribute('height', height);

                // –î–æ–¥–∞—î–º–æ —Ñ–æ–Ω
                const bgGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                bgGroup.setAttribute('id', 'background-layer');
                bgGroup.innerHTML = bgSvg.innerHTML;
                finalSvg.appendChild(bgGroup);

                // –î–æ–¥–∞—î–º–æ —ñ–∫–æ–Ω–∫—É –ø–æ —Ü–µ–Ω—Ç—Ä—É
                const iconGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                iconGroup.setAttribute('id', 'icon-layer');
                
                // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —Ä–æ–∑–º—ñ—Ä —Ç–∞ –ø–æ–∑–∏—Ü—ñ—é —ñ–∫–æ–Ω–∫–∏
                const iconViewBox = iconSvgEl.getAttribute('viewBox') || '0 0 24 24';
                const [, , iconW, iconH] = iconViewBox.split(' ').map(Number);
                
                const targetSize = Math.min(width, height) * (iconSizePercent / 100);
                const scale = targetSize / Math.max(iconW, iconH);
                const translateX = (width - iconW * scale) / 2;
                const translateY = (height - iconH * scale) / 2;
                
                iconGroup.setAttribute('transform', `translate(${translateX}, ${translateY}) scale(${scale})`);
                iconGroup.innerHTML = iconSvgEl.innerHTML;
                finalSvg.appendChild(iconGroup);

                // –ü–æ–∫–∞–∑—É—î–º–æ –ø—Ä–µ–≤'—é
                const preview = document.getElementById('preview');
                preview.innerHTML = '';
                preview.appendChild(finalSvg);

                // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö
                const successMsg = document.getElementById('successMsg');
                successMsg.textContent = '‚úÖ –ü—Ä–µ–≤\'—é —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ!';
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);

            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–≤\'—é:', error);
                alert('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–≤\'—é: ' + error.message);
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è SVG
        function downloadSVG() {
            const preview = document.getElementById('preview');
            const svg = preview.querySelector('svg');
            
            if (!svg) {
                alert('–°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–µ–≤\'—é!');
                return;
            }

            // –°–µ—Ä—ñ–∞–ª—ñ–∑—É—î–º–æ SVG
            const serializer = new XMLSerializer();
            let svgString = serializer.serializeToString(svg);
            
            // –î–æ–¥–∞—î–º–æ XML –¥–µ–∫–ª–∞—Ä–∞—Ü—ñ—é
            svgString = '<?xml version="1.0" encoding="UTF-8"?>\n' + svgString;

            // –°—Ç–≤–æ—Ä—é—î–º–æ Blob —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ
            const blob = new Blob([svgString], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'icon-with-background.svg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PNG
        function downloadPNG() {
            const preview = document.getElementById('preview');
            const svg = preview.querySelector('svg');
            
            if (!svg) {
                alert('–°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–µ–≤\'—é!');
                return;
            }

            const width = parseInt(document.getElementById('outputWidth').value) || 512;
            const height = parseInt(document.getElementById('outputHeight').value) || 512;

            // –°–µ—Ä—ñ–∞–ª—ñ–∑—É—î–º–æ SVG
            const serializer = new XMLSerializer();
            const svgString = serializer.serializeToString(svg);

            // –°—Ç–≤–æ—Ä—é—î–º–æ Blob –∑ SVG
            const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });
            const url = URL.createObjectURL(svgBlob);

            // –°—Ç–≤–æ—Ä—é—î–º–æ Image
            const img = new Image();
            img.onload = function() {
                // –°—Ç–≤–æ—Ä—é—î–º–æ canvas
                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');

                // –ú–∞–ª—é—î–º–æ –Ω–∞ canvas
                ctx.drawImage(img, 0, 0, width, height);

                // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ PNG —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ
                canvas.toBlob(function(blob) {
                    const pngUrl = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = pngUrl;
                    a.download = `icon-with-background-${width}x${height}.png`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(pngUrl);
                    URL.revokeObjectURL(url);
                }, 'image/png');
            };

            img.onerror = function() {
                alert('–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó SVG –≤ PNG. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
                URL.revokeObjectURL(url);
            };

            img.src = url;
        }

        // –î–æ–¥–∞—î–º–æ –ø—Ä–∏–∫–ª–∞–¥–∏ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–∏–∫–ª–∞–¥ —Ñ–æ–Ω—É
            const exampleBackground = `<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
  </defs>
  <rect width="200" height="200" fill="url(#grad1)" />
  <circle cx="200" cy="0" r="80" fill="rgba(255,255,255,0.1)" />
  <circle cx="0" cy="200" r="80" fill="rgba(255,255,255,0.1)" />
</svg>`;

            // –ü—Ä–∏–∫–ª–∞–¥ —ñ–∫–æ–Ω–∫–∏ (–∑—ñ—Ä–∫–∞)
            const exampleIcon = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" 
        fill="white" stroke="rgba(0,0,0,0.2)" stroke-width="0.5"/>
</svg>`;

            document.getElementById('backgroundSvg').value = exampleBackground;
            document.getElementById('iconSvg').value = exampleIcon;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–∫–∞–∑—É—î–º–æ –ø—Ä–µ–≤'—é
            updatePreview();
        });
    </script>
</body>
</html>
