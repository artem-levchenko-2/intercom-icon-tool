<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Icon Generator - PNG Background</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls {
            display: grid;
            gap: 15px;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-group input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
        }

        .slider-group input[type="range"]::-webkit-slider-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .slider-group span {
            min-width: 60px;
            text-align: right;
            font-weight: 600;
            color: #667eea;
        }

        .color-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .color-group input[type="color"] {
            width: 60px;
            height: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
        }

        .color-group input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: monospace;
        }

        .preview-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #preview {
            max-width: 100%;
            max-height: 400px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        .error {
            color: #ef4444;
            font-size: 14px;
            margin-top: 8px;
            display: none;
        }

        .success-msg {
            background: #10b981;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            text-align: center;
            font-weight: 500;
        }

        .info-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .info-box strong {
            color: #856404;
        }

        .info-box ul {
            margin: 10px 0 0 20px;
            color: #856404;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® Icon Generator</h1>
            <p>–ù–∞–∫–ª–∞–¥–∞–Ω–Ω—è SVG —ñ–∫–æ–Ω–∫–∏ –Ω–∞ PNG —Ñ–æ–Ω</p>
        </div>

        <div class="success-msg" id="successMsg"></div>

        <div class="info-box">
            <strong>üìù –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong>
            <ul>
                <li>–í—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥ –≤–∞—à–æ—ó —ñ–∫–æ–Ω–∫–∏</li>
                <li>–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Ä–æ–∑–º—ñ—Ä —Ç–∞ –∫–æ–ª—ñ—Ä —ñ–∫–æ–Ω–∫–∏</li>
                <li>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–µ–≤'—é"</li>
                <li>–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ PNG (—Ä–æ–∑–º—ñ—Ä –±—É–¥–µ —è–∫ —É BG.png)</li>
            </ul>
            <div id="bgInfo" style="margin-top: 10px; padding: 8px; background: #fff; border-radius: 5px; font-size: 14px; display: none;">
                <strong>üìê –†–æ–∑–º—ñ—Ä–∏ —Ñ–æ–Ω—É:</strong> <span id="bgDimensions">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
            </div>
        </div>

        <div class="main-content">
            <div class="card">
                <div class="card-title">
                    üéØ SVG –Ü–∫–æ–Ω–∫–∞
                </div>
                
                <div class="input-group">
                    <label for="iconSvg">–í—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥ —ñ–∫–æ–Ω–∫–∏:</label>
                    <textarea id="iconSvg" placeholder='<svg viewBox="0 0 24 24">...</svg>'></textarea>
                    <div class="error" id="iconError"></div>
                </div>

                <div class="controls">
                    <div class="input-group">
                        <label>–†–æ–∑–º—ñ—Ä —ñ–∫–æ–Ω–∫–∏:</label>
                        <div class="slider-group">
                            <input type="range" id="iconSize" min="10" max="90" value="60" step="5">
                            <span id="iconSizeValue">60%</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>–ö–æ–ª—ñ—Ä —ñ–∫–æ–Ω–∫–∏:</label>
                        <div class="color-group">
                            <input type="color" id="iconColorPicker" value="#334150">
                            <input type="text" id="iconColorText" value="#334150" placeholder="#334150">
                        </div>
                    </div>


                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="updatePreview()">üîÑ –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–µ–≤'—é</button>
                </div>
            </div>

            <div class="card">
                <div class="card-title">
                    üëÅÔ∏è –ü—Ä–µ–≤'—é
                </div>
                
                <div class="preview-container">
                    <canvas id="preview"></canvas>
                </div>

                <div class="button-group">
                    <button class="btn-success" onclick="downloadPNG()">üíæ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ PNG</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        let bgImage = null;
        let isPreviewReady = false;

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–æ–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
        window.addEventListener('DOMContentLoaded', function() {
            const img = new Image();
            img.onload = function() {
                bgImage = img;
                
                // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–æ–∑–º—ñ—Ä–∏ —Ñ–æ–Ω—É
                document.getElementById('bgDimensions').textContent = `${img.width} √ó ${img.height} px`;
                document.getElementById('bgInfo').style.display = 'block';
                
                loadExample();
            };
            img.onerror = function() {
                alert('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è BG.png. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ –ø–∞–ø–∫–∏.');
            };
            img.src = 'BG.png';

            // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è —Å–ª–∞–π–¥–µ—Ä—ñ–≤
            document.getElementById('iconSize').addEventListener('input', function() {
                document.getElementById('iconSizeValue').textContent = this.value + '%';
            });

            // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è color picker —Ç–∞ text input
            document.getElementById('iconColorPicker').addEventListener('input', function() {
                document.getElementById('iconColorText').value = this.value;
            });

            document.getElementById('iconColorText').addEventListener('input', function() {
                const color = this.value;
                if (/^#[0-9A-F]{6}$/i.test(color)) {
                    document.getElementById('iconColorPicker').value = color;
                }
            });
        });

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø—Ä–∏–∫–ª–∞–¥
        function loadExample() {
            const exampleIcon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
<path opacity=".4" d="M96 320C96 311.8 96.4 303.7 97.1 295.9C106.3 290.8 116.8 288 128 288C163.3 288 192 316.7 192 352C192 387.3 163.3 416 128 416C123.7 416 119.4 415.6 115.3 414.7C103.4 388.5 96 356 96 320zM352 320C352 311.8 352.4 303.7 353.1 295.9C362.3 290.8 372.8 288 384 288C419.3 288 448 316.7 448 352C448 387.3 419.3 416 384 416C379.7 416 375.4 415.6 371.3 414.7C359.4 388.5 352 356 352 320z"/>
<path d="M96 320C96 272.4 108.9 230.8 128.1 202C147.4 173 170.7 160 192 160C213.3 160 236.5 173 255.9 202C275.1 230.8 288 272.4 288 320C288 367.6 275.1 409.2 255.9 438C236.6 467 213.3 480 192 480C170.7 480 147.5 467 128.1 438C108.9 409.2 96 367.6 96 320zM320 184.6C316.6 178.3 313 172.2 309.1 166.4C282.1 125.9 241.3 95.9 192 95.9C142.7 95.9 101.8 126 74.9 166.5C47.7 207.2 32 261.5 32 320C32 378.5 47.7 432.8 74.9 473.5C101.8 514 142.6 544 192 544C241.4 544 282.2 514 309.1 473.5C313 467.7 316.6 461.7 320 455.3C323.4 461.6 327 467.7 330.9 473.5C357.9 514 398.7 544 448 544C497.3 544 538.2 514 565.1 473.5C592.3 432.8 608 378.5 608 320C608 261.5 592.3 207.2 565.1 166.5C538.2 126 497.4 96 448 96C398.6 96 357.8 126 330.9 166.5C327 172.3 323.4 178.3 320 184.7zM352 320C352 272.4 364.9 230.8 384.1 202C403.5 173 426.7 160 448 160C469.3 160 492.5 173 511.9 202C531.1 230.8 544 272.4 544 320C544 367.6 531.1 409.2 511.9 438C492.5 467 469.3 480 448 480C426.7 480 403.5 467 384.1 438C364.9 409.2 352 367.6 352 320z"/>
</svg>`;
            document.getElementById('iconSvg').value = exampleIcon;
        }

        // –û—á–∏—â–µ–Ω–Ω—è SVG
        function cleanSVG(svgString) {
            return svgString
                .replace(/<\?xml[^>]*\?>/g, '')
                .replace(/<!DOCTYPE[^>]*>/g, '')
                .replace(/<!--[\s\S]*?-->/g, '')
                .trim();
        }

        // –í–∞–ª—ñ–¥–∞—Ü—ñ—è SVG
        function validateSVG(svgString, errorId) {
            const errorElement = document.getElementById(errorId);
            
            if (!svgString.trim()) {
                errorElement.textContent = '‚ö†Ô∏è –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ SVG –∫–æ–¥';
                errorElement.style.display = 'block';
                return false;
            }

            if (!svgString.includes('<svg')) {
                errorElement.textContent = '‚ö†Ô∏è –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π SVG. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ –∫–æ–¥ –º—ñ—Å—Ç–∏—Ç—å —Ç–µ–≥ <svg>';
                errorElement.style.display = 'block';
                return false;
            }

            errorElement.style.display = 'none';
            return true;
        }

        // –ó–∞–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—É –≤ SVG
        function changeSVGColor(svgString, color) {
            // –ü–∞—Ä—Å–∏–º–æ SVG
            const parser = new DOMParser();
            const doc = parser.parseFromString(svgString, 'image/svg+xml');
            const svg = doc.querySelector('svg');

            if (!svg) return svgString;

            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ fill
            const elements = svg.querySelectorAll('[fill]');
            elements.forEach(el => {
                const fill = el.getAttribute('fill');
                // –ù–µ –º—ñ–Ω—è—î–º–æ "none" —Ç–∞ url (–≥—Ä–∞–¥—ñ—î–Ω—Ç–∏, –ø–∞—Ç–µ—Ä–Ω–∏)
                if (fill && fill !== 'none' && !fill.startsWith('url')) {
                    el.setAttribute('fill', color);
                }
            });

            // –Ø–∫—â–æ –Ω–µ–º–∞—î fill –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, –¥–æ–¥–∞—î–º–æ –¥–æ –≤—Å—ñ—Ö path
            if (elements.length === 0) {
                const paths = svg.querySelectorAll('path, circle, rect, polygon, ellipse');
                paths.forEach(el => {
                    if (el.getAttribute('fill') !== 'none') {
                        el.setAttribute('fill', color);
                    }
                });
            }

            // –°–µ—Ä—ñ–∞–ª—ñ–∑—É—î–º–æ –Ω–∞–∑–∞–¥
            const serializer = new XMLSerializer();
            return serializer.serializeToString(svg);
        }

        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–≤'—é
        function updatePreview() {
            if (!bgImage) {
                alert('–§–æ–Ω —â–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è. –ó–∞—á–µ–∫–∞–π—Ç–µ —Å–µ–∫—É–Ω–¥—É.');
                return;
            }

            const iconSvg = document.getElementById('iconSvg').value;
            const iconSizePercent = parseInt(document.getElementById('iconSize').value);
            const iconColor = document.getElementById('iconColorText').value;

            // –í–∞–ª—ñ–¥–∞—Ü—ñ—è
            if (!validateSVG(iconSvg, 'iconError')) {
                return;
            }

            try {
                // –û—á–∏—â–∞—î–º–æ —Ç–∞ –∑–º—ñ–Ω—é—î–º–æ –∫–æ–ª—ñ—Ä SVG
                let cleanedIcon = cleanSVG(iconSvg);
                cleanedIcon = changeSVGColor(cleanedIcon, iconColor);

                // –ü–∞—Ä—Å–∏–º–æ SVG –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—ñ–≤
                const parser = new DOMParser();
                const doc = parser.parseFromString(cleanedIcon, 'image/svg+xml');
                const iconSvgEl = doc.querySelector('svg');

                if (!iconSvgEl) {
                    throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ SVG —ñ–∫–æ–Ω–∫–∏');
                }

                // –û—Ç—Ä–∏–º—É—î–º–æ —Ä–æ–∑–º—ñ—Ä–∏ —ñ–∫–æ–Ω–∫–∏
                const viewBox = iconSvgEl.getAttribute('viewBox');
                let iconW, iconH;
                
                if (viewBox) {
                    [, , iconW, iconH] = viewBox.split(' ').map(Number);
                } else {
                    iconW = parseFloat(iconSvgEl.getAttribute('width')) || 24;
                    iconH = parseFloat(iconSvgEl.getAttribute('height')) || 24;
                }

                // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ viewBox —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î
                if (!viewBox) {
                    iconSvgEl.setAttribute('viewBox', `0 0 ${iconW} ${iconH}`);
                }

                // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ SVG –≤ —Å—Ç—Ä–æ–∫—É
                const serializer = new XMLSerializer();
                const svgString = serializer.serializeToString(iconSvgEl);

                // –°—Ç–≤–æ—Ä—é—î–º–æ Blob —Ç–∞ URL –¥–ª—è —ñ–∫–æ–Ω–∫–∏
                const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });
                const iconUrl = URL.createObjectURL(svgBlob);

                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —ñ–∫–æ–Ω–∫—É —è–∫ Image
                const iconImg = new Image();
                
                iconImg.onload = function() {
                    // –ú–∞–ª—é—î–º–æ –Ω–∞ canvas
                    const canvas = document.getElementById('preview');
                    const ctx = canvas.getContext('2d');
                    
                    // –†–æ–∑–º—ñ—Ä–∏ —Ñ–æ–Ω—É
                    const bgW = bgImage.width;
                    const bgH = bgImage.height;
                    
                    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–∑–º—ñ—Ä canvas
                    canvas.width = bgW;
                    canvas.height = bgH;

                    // –ú–∞–ª—é—î–º–æ —Ñ–æ–Ω
                    ctx.drawImage(bgImage, 0, 0, bgW, bgH);

                    // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —Ä–æ–∑–º—ñ—Ä —Ç–∞ –ø–æ–∑–∏—Ü—ñ—é —ñ–∫–æ–Ω–∫–∏
                    const targetSize = Math.min(bgW, bgH) * (iconSizePercent / 100);
                    const scale = targetSize / Math.max(iconW, iconH);
                    const scaledW = iconW * scale;
                    const scaledH = iconH * scale;
                    const x = (bgW - scaledW) / 2;
                    const y = (bgH - scaledH) / 2;

                    // –ú–∞–ª—é—î–º–æ —ñ–∫–æ–Ω–∫—É
                    ctx.drawImage(iconImg, x, y, scaledW, scaledH);

                    // –û—á–∏—â–∞—î–º–æ URL
                    URL.revokeObjectURL(iconUrl);

                    isPreviewReady = true;

                    // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                    const successMsg = document.getElementById('successMsg');
                    successMsg.textContent = '‚úÖ –ü—Ä–µ–≤\'—é –≥–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ PNG';
                    successMsg.style.display = 'block';
                    setTimeout(() => {
                        successMsg.style.display = 'none';
                    }, 3000);
                };

                iconImg.onerror = function() {
                    URL.revokeObjectURL(iconUrl);
                    alert('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ–∫–æ–Ω–∫–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ SVG –∫–æ–¥.');
                };

                iconImg.src = iconUrl;

            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–≤\'—é:', error);
                alert('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–≤\'—é: ' + error.message);
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PNG
        function downloadPNG() {
            if (!isPreviewReady) {
                alert('–°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–µ–≤\'—é!');
                return;
            }

            const canvas = document.getElementById('preview');
            
            // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ canvas —è–∫ —î, –±–µ–∑ –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—ñ–≤
            canvas.toBlob(function(blob) {
                downloadBlob(blob, `icon-${canvas.width}x${canvas.height}.png`);
            }, 'image/png');
        }

        // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è blob
        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            const successMsg = document.getElementById('successMsg');
            successMsg.textContent = '‚úÖ PNG –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!';
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>